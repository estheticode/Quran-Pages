<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø³ÙˆØ±Ø© Ø§Ù„ÙØ§ØªØ­Ø©</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  body {
    font-family: 'Arial', sans-serif;
    background: #F4E4C1;
    color: #000;
    padding: 20px;
    text-align: center;
    direction: rtl;
    transition: background 0.3s, color 0.3s;

    max-width: 1000px;  /* limits width on large screens */
    margin: 0 auto;      /* centers content horizontally */
    box-sizing: border-box; /* includes padding in width */
  }
  body.dark { background: #121212; color: #f0f0f0; }

  /* Header */
  #header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }

  /* Page dropdown on left */
  #pageSelect {
    padding: 6px 12px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #aaa;
    background: #fff;
    cursor: pointer;
    order: 0;
    margin-left: auto; /* left in RTL */
  }
  body.dark #pageSelect { background:#222; color:#f0f0f0; border-color:#555; }

  /* Buttons container on right */
  #buttonsContainer {
    display: flex;
    gap: 10px;
    order: 1;
  }
  #buttonsContainer button {
    padding: 6px 12px;
    font-size: 18px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    background: #e0e0e0;
    color: #000;
  }
  #buttonsContainer button:hover { background: #d0d0d0; }
  body.dark #buttonsContainer button { background: #333; color: #f0f0f0; }

  h1#surahName { font-size: 40px; margin-bottom: 10px; }
  .bismillah { font-size: 26px; font-weight: bold; color: #555; margin-bottom: 25px; }
  body.dark .bismillah { color:#ccc; }

  #versesContainer { max-width: 100%; margin: 0 auto; line-height: 2; }

  .verse { font-size: 24px; margin: 12px 0; display: inline; position: relative; }
  .verse-number { color: green; font-weight: bold; margin-left: 8px; cursor: pointer; }

  /* Fixed popover near button */
  .popover {
    display: none;
    position: fixed;          /* fixed relative to viewport */
    background-color: #fff;
    color: #000;
    border: 1px solid #aaa;
    border-radius: 8px;
    padding: 10px 14px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.25);
    z-index: 9999;
    font-size: 16px;
    max-width: 280px;
    text-align: left;
    line-height: 1.4;
    direction: ltr;
  }
  body.dark .popover { background:#222; color:#f0f0f0; border-color:#555; }

  @media (max-width: 500px) {
    h1#surahName { font-size: 32px; }
    .bismillah { font-size: 20px; margin-bottom: 15px; }
    .verse { font-size: 20px; }
    #buttonsContainer button { font-size: 16px; padding: 5px 10px; }
    #pageSelect { font-size: 14px; padding: 5px 10px; }
  }
</style>
</head>
<body>

<div id="header">
  <select id="pageSelect"></select>

  <div id="buttonsContainer">
    <button id="fontIncrease">+</button>
    <button id="fontDecrease">âˆ’</button>
    <button id="themeBtn">ğŸŒ™</button>
  </div>
</div>

<h1 id="surahName">Ø§Ù„ÙØ§ØªØ­Ø©</h1>
<div class="bismillah">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„Ø±Ù‘ÙØ­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±Ù‘ÙØ­ÙÙŠÙ…Ù</div>

<div id="versesContainer"></div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

const surahData = {
  name: "Ø§Ù„ÙØ§ØªØ­Ø©",
  verses: [
    {arabic: "Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„Ù‘ÙÙ‡Ù Ø±ÙØ¨Ù‘Ù Ø§Ù„Ù’Ø¹ÙØ§Ù„ÙÙ…ÙÙŠÙ†Ù", translation: "All praise is due to Allah, Lord of the worlds."},
    {arabic: "Ø§Ù„Ø±Ù‘ÙØ­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±Ù‘ÙØ­ÙÙŠÙ…Ù", translation: "The Most Gracious, the Most Merciful."},
    {arabic: "Ù…ÙØ§Ù„ÙÙƒÙ ÙŠÙÙˆÙ’Ù…Ù Ø§Ù„Ø¯Ù‘ÙÙŠÙ†Ù", translation: "Master of the Day of Judgment."},
    {arabic: "Ø¥ÙÙŠÙ‘ÙØ§ÙƒÙ Ù†ÙØ¹Ù’Ø¨ÙØ¯Ù ÙˆÙØ¥ÙÙŠÙ‘ÙØ§ÙƒÙ Ù†ÙØ³Ù’ØªÙØ¹ÙÙŠÙ†Ù", translation: "You alone we worship, and You alone we ask for help."},
    {arabic: "Ø§Ù‡Ù’Ø¯ÙÙ†ÙØ§ Ø§Ù„ØµÙ‘ÙØ±ÙØ§Ø·Ù Ø§Ù„Ù’Ù…ÙØ³Ù’ØªÙÙ‚ÙÙŠÙ…Ù", translation: "Guide us to the straight path."},
    {arabic: "ØµÙØ±ÙØ§Ø·Ù Ø§Ù„Ù‘ÙØ°ÙÙŠÙ†Ù Ø£ÙÙ†Ù’Ø¹ÙÙ…Ù’ØªÙ Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ØºÙÙŠÙ’Ø±Ù Ø§Ù„Ù’Ù…ÙØºÙ’Ø¶ÙÙˆØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ÙˆÙÙ„ÙØ§ Ø§Ù„Ø¶Ù‘ÙØ§Ù„Ù‘ÙÙŠÙ†Ù", translation: "The path of those upon whom You have bestowed favor, not of those who have evoked [Your] anger or of those who are astray."}
  ]
};

const maxVersesPerPage = 16;
const totalPages = Math.ceil(surahData.verses.length / maxVersesPerPage);
const pages = [];
for(let i=0; i<totalPages; i++){
  pages.push(surahData.verses.slice(i*maxVersesPerPage, (i+1)*maxVersesPerPage));
}

const pageSelect = document.getElementById('pageSelect');
for(let i=0; i<totalPages; i++){
  const option = document.createElement('option');
  option.value = i;
  option.text = "Page " + (i+1);
  pageSelect.appendChild(option);
}

let currentFontSize = 24;
const versesContainer = document.getElementById('versesContainer');

function displayVerses(pageIndex=0){
  versesContainer.innerHTML = "";
  pages[pageIndex].forEach((verse, idx)=>{
    const verseDiv = document.createElement('div');
    verseDiv.className = "verse";
    verseDiv.style.fontSize = currentFontSize + "px";
    const verseNumber = pageIndex*maxVersesPerPage + idx + 1;
    verseDiv.innerHTML = `
      ${verse.arabic} <span class="verse-number" data-index="${verseNumber-1}">[${verseNumber}]</span>
      <div class="popover" id="popover-${verseNumber-1}">${verse.translation}</div>
    `;
    versesContainer.appendChild(verseDiv);
  });

  document.querySelectorAll('.verse-number').forEach(el=>{
    el.addEventListener('click', ()=>{
      const idx = el.dataset.index;
      const pop = document.getElementById('popover-' + idx);

      // hide other popovers
      document.querySelectorAll('.popover').forEach(p=>{
        if(p!==pop) p.style.display='none';
      });

      if(pop.style.display==='block'){
        pop.style.display='none';
        return;
      }

      // position popover near button (fixed, ignores body margins)
      const rect = el.getBoundingClientRect();
      pop.style.top = (rect.bottom + 8) + "px"; // 8px below button
      pop.style.left = rect.left + "px";

      // keep inside viewport horizontally
      const popWidth = pop.offsetWidth;
      if(rect.left + popWidth > window.innerWidth - 8){
        pop.style.left = (window.innerWidth - popWidth - 8) + "px";
      }

      pop.style.display='block';
    });
  });

  document.addEventListener('click', e=>{
    if(!e.target.classList.contains('verse-number')){
      document.querySelectorAll('.popover').forEach(p=>p.style.display='none');
    }
  });
}

displayVerses(0);

pageSelect.addEventListener('change', e=>{
  displayVerses(parseInt(e.target.value));
});

const themeBtn = document.getElementById('themeBtn');
themeBtn.addEventListener('click', ()=>{
  document.body.classList.toggle('dark');
  themeBtn.textContent = document.body.classList.contains('dark') ? "â˜€ï¸" : "ğŸŒ™";
});

document.getElementById('fontIncrease').addEventListener('click', ()=>{
  if(currentFontSize < 40){ currentFontSize += 2; displayVerses(parseInt(pageSelect.value)); }
});
document.getElementById('fontDecrease').addEventListener('click', ()=>{
  if(currentFontSize > 14){ currentFontSize -= 2; displayVerses(parseInt(pageSelect.value)); }
});
</script>

</body>
</html>
